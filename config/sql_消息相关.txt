#查询聊天信息,最近的10条
SELECT * FROM 
(SELECT a.id,a.`from_id`,a.`to_id`,a.`type`,a.`content`,a.time,b.state FROM message AS a LEFT JOIN message_state AS b ON a.id=b.msg_id AND b.pid='oCBrx0ExpR4J4DM1qM342xQ4HYWQ'
WHERE TYPE=3 AND state!=2 AND
((a.from_id='oCBrx0ExpR4J4DM1qM342xQ4HYWQ' AND a.to_id='oCBrx0FreB-L8pIQM5_RYDGoWOKQ') OR
(a.from_id='oCBrx0FreB-L8pIQM5_RYDGoWOKQ' AND a.to_id='oCBrx0ExpR4J4DM1qM342xQ4HYWQ')) ORDER BY TIME DESC LIMIT 0,10)AS a
ORDER BY TIME ASC



#查询聊天列表(最后一条消息)
SELECT * FROM message WHERE id IN(
SELECT MAX(id) FROM (
(SELECT * FROM message WHERE  from_id='oCBrx0FreB-L8pIQM5_RYDGoWOKQ' AND TYPE=3 AND state!=2
UNION
SELECT * FROM message WHERE  to_id='oCBrx0FreB-L8pIQM5_RYDGoWOKQ' AND TYPE=3 AND state!=2)

)AS b GROUP BY b.from_id,b.to_id
)

 UNION 
 
 SELECT * FROM ( 
 SELECT * FROM message WHERE to_id='oCBrx0FreB-L8pIQM5_RYDGoWOKQ' AND (TYPE=1 OR TYPE=2)ORDER BY TIME DESC LIMIT 0,1) AS b
 
 ORDER BY TIME DESC
 
 
 
 #查询账单相关的消息
 SELECT * FROM message WHERE 
content LIKE '[Create]:vKzGZBfU67lSXhkkbt7GLg==%' OR 
content LIKE '[CreateInner]:vKzGZBfU67lSXhkkbt7GLg==%' OR
content LIKE '[Settle]:vKzGZBfU67lSXhkkbt7GLg==%' 
 